\documentclass[12pt, psamsfonts]{amsart}

%-------Packages---------
\usepackage{amssymb,amsfonts}
\usepackage{xcolor,colortbl}
\usepackage{semantic}
\usepackage{fullpage}
\usepackage{units}
\usepackage{tikz-cd}
\usepackage{todonotes}
\usepackage{physics}
\usepackage[all,arc]{xy}
\usepackage{enumerate}
\usepackage{enumitem}
\usepackage{mathrsfs}
\usepackage{theoremref}
\usepackage{graphicx}
\usepackage[bookmarks]{hyperref}

\usepackage{amsthm}
\makeatletter
\def\th@plain{%
  \thm@notefont{}% same as heading font
  \itshape % body font
}
\def\th@definition{%
  \thm@notefont{}% same as heading font
  \normalfont % body font
}
\makeatother

%--------Theorem Environments--------
%theoremstyle{plain} --- default
\newtheorem{thm}{Theorem}[subsection]
\newtheorem{cor}[thm]{Corollary}
\newtheorem{prop}[thm]{Proposition}
\newtheorem{lem}[thm]{Lemma}
\newtheorem{conj}[thm]{Conjecture}
\newtheorem{quest}[thm]{Question}

\theoremstyle{definition}
\newtheorem{defn}[thm]{Definition}
\newtheorem{defns}[thm]{Definitions}
\newtheorem{con}[thm]{Construction}
\newtheorem{exmp}[thm]{Example}
\newtheorem{exmps}[thm]{Examples}
\newtheorem{notn}[thm]{Notation}
\newtheorem{notns}[thm]{Notations}
\newtheorem{addm}[thm]{Addendum}
\newtheorem*{exer}{Exercise}

\theoremstyle{remark}
\newtheorem{rem}[thm]{Remark}
\newtheorem{rems}[thm]{Remarks}
\newtheorem{warn}[thm]{Warning}
\newtheorem{sch}[thm]{Scholium}

\DeclareMathOperator{\En}{\textsf{En}}
\DeclareMathOperator{\Rep}{\textsf{Rep}}
\DeclareMathOperator{\true}{\textsf{true}}
\DeclareMathOperator{\false}{\textsf{false}}
\DeclareMathOperator{\nand}{\overline{\land}}
\newcommand{\textoverline}[1]{$\overline{\mbox{#1}}$}


\makeatletter
\makeatother
\numberwithin{equation}{subsection}

\bibliographystyle{plain}

\setcounter{tocdepth}{3}
\makeatletter
\def\l@subsection{\@tocline{2}{0pt}{2.5pc}{5pc}{}}
\makeatother

\begin{document}

\title{The Calculus of Computation}
\author{Hidenori Shinohara}

\maketitle

\section{Chapter 1}

\begin{exer}[1.1]
    $ $
    \begin{enumerate}[label=(\alph*)]
        \item
            Assume that there is a falsifying interpretation $I$.
            \begin{enumerate}[label=\arabic*.]
                \item % 1
                    $I \not\models P \land Q \rightarrow P \rightarrow Q$ (assumption)
                \item % 2
                    $I \models P \land Q$ (by 1 and semantics of $\rightarrow$)
                \item % 3
                    $I \not\models P \rightarrow Q$ (by 1 and semantics of $\rightarrow$)
                \item % 4
                    $I \models Q$ (by 2 and semantics of $\land$)
                \item % 5
                    $I \not\models Q$ (by 3 and semantics of $\rightarrow$)
                \item % 6
                    $I \models \bot$ (4 and 5 are contradictory)
            \end{enumerate}
            There is only one branch and it is closed.
            Thus $F$ is valid.
        \item
            By constructing a truth table which has $2^2 = 4$ rows, it is easy to see that the interpretation $I: \{ P \mapsto \textsf{false}, Q \mapsto \textsf{true} \}$ is a falsifying interpretation.
        \item
            By constructing a truth table which has $2^3 = 8$ rows, it is easy to see that the interpretation $I: \{ P \mapsto \textsf{true}, Q \mapsto \textsf{false}, R \mapsto \textsf{false} \}$ is a falsifying interpretation.
    \end{enumerate}
\end{exer}

\begin{exer}[1.2]
    $ $
    \begin{enumerate}[label=(\alph*)]
        \item
            To prove that $\top \Leftrightarrow \neg \bot$, we prove that $\top \leftrightarrow \neg \bot$ is valid.
            Assume that there is a falsifying interpretation $I$ such that $I \not\models \top \leftrightarrow \neg \bot$.
            We apply the semantics of $\leftrightarrow$.

            The first branch is:
            \begin{enumerate}[label=\arabic*a.]
                \item % 1a
                    $I \models \top \land \neg(\neg \bot)$ 
                \item % 2a
                    $I \models \neg(\neg \bot)$ (by 1a and semantics of $\land$)
                \item % 3a
                    $I \not\models \neg \bot$ (by 2a and semantics of $\neg$)
                \item % 4a
                    $I \models \bot$ (by 3a and semantics of $\neg$)
            \end{enumerate}

            The second branch is:
            \begin{enumerate}[label=\arabic*b.]
                \item % 1b
                    $I \models \neg \top \land \neg \bot$ 
                \item % 2b
                    $I \models \neg \top$ (by 1b and semantics of $\land$)
                \item % 3b
                    $I \not\models \top$ (by 2b and semantics of $\neg$)
                \item % 4b
                    $I \models \top$ (Under any interpretation, $\top$ has value true)
                \item % 5b
                    $I \models \bot$ (3b and 4b are contradictory)
            \end{enumerate}
            Thus both branches are closed, and thus $\top \leftrightarrow \neg \bot$ is valid.
        \item
            We will apply a strategy similar to that of Example 1.13.
            To prove $\bot \Leftrightarrow \neg \top$, we prove that $F: \bot \leftrightarrow \neg \top$ is valid.
            Suppose $F$ is not valid; there exists an interpretation $I$ such that $I \not\models F$.
            There are exactly two branches.

            The first branch is:
            \begin{enumerate}[label=\arabic*a.]
                \item % 1a
                    $I \models \bot \land \neg (\neg \top)$ (by semantics of $\leftrightarrow$)
                \item % 2a
                    $I \models \bot$ (by 1a and semantics of $\land$)
            \end{enumerate}

            The second branch is:
            \begin{enumerate}[label=\arabic*b.]
                \item % 1b
                    $I \models (\neg \bot) \land \neg (\neg \top)$ (by semantics of $\leftrightarrow$)
                \item % 2b
                    $I \models \neg\top$ (by 1b and semantics of $\land$)
                \item % 3b
                    $I \not\models \top$ (by 2b and semantics of $\neg$)
                \item % 4b
                    $I \models \top$ (by definition, P.7)
                \item % 5b
                    $I \models \bot$ (by 3b and 4b)
            \end{enumerate}
            Both of these two branches are closed; $F$ is valid.
    \end{enumerate}
\end{exer}

\begin{exer}[1.3]
    $ $
    \begin{itemize}
        \item
            $\bot$ is equivalent to $\neg \top$.
            In other words, $\bot \Leftrightarrow \neg \top$ and that is proved in Exercise 1.2(b).
    \end{itemize}
\end{exer}

\begin{exer}[1.4]
    $ $
    \begin{itemize}
        \item
            We claim that $\neg F \Leftrightarrow F \nand F$.
            To prove that, we prove $\neg F \leftrightarrow F \nand F$ is valid.
            \begin{center}
                \begin{tabular}{ |c|c|c||c| }
                    \hline
                    $F$ & $\neg F$ & $F \nand F$ & $\neg F \leftrightarrow F \nand F$\\
                    \hline
                    0 & 1 & 1 & 1 \\
                    \hline
                    1 & 0 & 0 & 1 \\
                    \hline
                \end{tabular}
            \end{center}
        \item
            $F_1 \lor F_2 \Leftrightarrow (F_1 \nand F_1) \nand (F_2 \nand F_2)$.
            This can be shown easily using the truth table with $2^2 = 4$ rows.
    \end{itemize}
\end{exer}

\begin{exer}[1.5]
    $ $
    \begin{enumerate}[label=(\alph*)]
        \item
            By using the list of template equivalences on P.19, we can obtain the negation normal form of the original formula as following:
            \begin{itemize}
                \item
                    $F: \neg (P \rightarrow Q)$.
                \item
                    $F': \neg (\neg P \lor Q)$.
                \item
                    $F'': \neg (\neg P) \land \neg Q$.
                \item
                    $F''': P \land \neg Q$.
            \end{itemize}
            The only connectives in $F'''$ are $\neg, \land$, and $\lor$ and the negations appear only in literals.
            Thus $F'''$ is in NNF.
            Furthermore, $F'''$ is actually in CNF and DNF since it is the disjunction of one conjunction, and it is the conjunction of two clauses.
        \item
            $F': (\neg P \lor \neg Q) \land R$ is the NNF of $F$ that can be obtained using the same strategy as above.
            $F'$ is already in CNF.
            $F'': (\neg P \land R) \lor (\neg Q \land R)$ is an equivalent formula in DNF.
        \item
            $F:(Q \land R \rightarrow (P \lor \neg Q)) \land (P \lor R)$.
            \begin{itemize}
                \item
                    $F_1: (\neg (Q \land R) \lor (P \lor \neg Q)) \land (P \lor R)$.
                \item
                    $F_2: (\neg Q \lor \neg R \lor P \lor \neg Q) \land (P \lor R)$.
                \item
                    $F_3: (\neg Q \land (P \lor R)) \lor (\neg R \land (P \lor R)) \lor (P \land (P \lor R)) \lor (\neg Q \land (P \lor R))$.
                \item
                    $F_4: (\neg Q \land P) \lor (\neg Q \land R) \lor (\neg R \land P) \lor (\neg R \land R) \lor (P \land P) \lor (P \land R) \lor (\neg Q \land P) \lor (\neg Q \land R)$.
            \end{itemize}
            $F_2$ is in NNF and CNF, and $F_4$ is in DNF.
    \end{enumerate}
\end{exer}

\begin{exer}[1.6]
    $ $
    \begin{enumerate}[label=(\alph*)]
        \item
            $\bigwedge\limits_{v \in V} \bigvee\limits_{c \in C} P^c_v$.
        \item
            $\bigwedge\limits_{(v, w) \in E} \bigvee\limits_{c_1 \ne c_2 \in C} (\neg P_v^{c_1} \vee \neg P^{c_2}_w)$.
        \item
            $\bigwedge\limits_{(v, w) \in E} \bigvee\limits_{c \in C} (\neg P_v^c \vee \neg P^c_w)$.
        \item
            No clue.
            The problem statement seems too ambiguous.
        \item
            They are already in CNF.
            We have $N \cdot M$ variables and $N \cdot M + K \cdot M \cdot (M - 1) + K \cdot M$ clauses in the encoding above.
    \end{enumerate}
\end{exer}

\begin{exer}[1.7]
    $ $
    \begin{enumerate}[label=(\alph*)]
        \item
            $P_{(F)}$ contains 1 term.
            Each $\En(G)$ contains $1, 1, 2 \cdot 2 \cdot 3, 1, 1, 2 \cdot 2 \cdot 3, 3 \cdot 2 \cdot 2$ clauses.
            Thus the expansion would contain 1728 clauses, which is the product of the numbers of clauses.
        \item
            $ $
            \begin{enumerate}[label=(\roman*)]
                \item
                    $2^n$ clauses.
                \item
                    $\Rep(F_n) = P_{F_n}$, so it is just one clause.
                    We have the subformula set $S_{F_n} = \{ Q_1, \cdots, Q_n \} \cup \{ R_1, \cdots, R_n \} \cup \{ Q_i \land R_i \mid 1 \leq i \leq n \}$.
                    We will consider how many clauses $\En(G)$ has for each $G \in S_{F_n}$.
                    \begin{itemize}
                        \item
                            For each $Q_i$ and $R_i$, we have $\En(Q_i) = \En(R_i) = \top$.
                            This adds $2n$ clauses to $F'$.
                        \item
                            $\En(Q_i \land R_i)$ contains 3 clauses as defined on P.25.
                            This adds $3n$ clauses to $F'$.
                    \end{itemize}
                    Therefore, in total, $F'$ contains $1 + 2n + 3n = 5n + 1$ clauses.
                    Note that $5n + 1 < 30n + 2$ where $30n + 2$ is the upper bound described on P.26.

                    I am not sure if a subformula can be bigger.
                    In other words, for instance, should $(Q_1 \land R_1) \lor (Q_2 \land R_2)$ be a subformula of $F_3$?
                    It seems unnecessary to include such cases for the purpose of CNF conversion, but it seems to be more consistent with the definition of a subformula.
                \item
                    When $n \leq 4$, $2^n$ is smaller than $5n + 1$.
                    For $n \geq 5$, $2^n$ is bigger than $5n + 1$.
            \end{enumerate}
    \end{enumerate}
\end{exer}

\begin{exer}[1.8]
    $ $
    \begin{enumerate}[label=(\alph*)]
        \item
            We will follow the format described in Example 1.30.
            Branching on $Q$ or $R$ will result in unit clauses; choose $Q$.
            Then $F\{ Q \mapsto \top \}: (P \lor \neg R) \land (R)$.
            $P$ appear only positively, so we consider $F\{ Q \mapsto \top, P \mapsto \top \}: R$.
            Then $R$ appears only positively, so the formula is satisfiable.
            In particular, $F$ is satisfied by interpretation
            \begin{align*}
                I: \{ P \mapsto \true, Q \mapsto \true, R \mapsto \true \}.
            \end{align*}
        \item
            Branching on $Q$ or $R$ will result in unit clauses.
            Choose $Q$.
            \begin{align*}
                F\{ Q \mapsto \top \}: (\neg P \lor \neg R) \land (R).
            \end{align*}
            $P$ appears only negatively.
            \begin{align*}
                F\{ P \mapsto \bot, Q \mapsto \top \}: R.
            \end{align*}
            $R$ appears only positively.
            Thus the interpretation $I: \{ P \mapsto \textsf{false}, Q \mapsto \textsf{true}, R \mapsto \textsf{true} \}$ satisfies $F$.
    \end{enumerate}
\end{exer}

\section{Chapter 2}

\begin{exer}[2.1]
    $ $
    \begin{enumerate}[label=(\alph*)]
        \item
            $\exists x, y.\, \text{day}(x) \land \text{day}(y) \land \text{length}(x) < \text{length}(y)$.
        \item
            $\exists x.\, \text{place}(x) \land \text{home}(x) \land (\forall y.\, \text{place}(y) \land \text{home}(y) \rightarrow x = y)$.
        \item
            $\forall x, y.\, \text{mother}(\text{me}, x) \land \text{mother}(x, y) \rightarrow \text{grandmother}(\text{me}, y)$.
        \item
            $\forall x, y, z.\, \text{convex}(x) \land \text{convex}(y) \land \text{intersect}(x, y, z) \rightarrow \text{convex}(z)$.
    \end{enumerate}
\end{exer}

\begin{exer}[2.2]
    $ $
    \begin{enumerate}[label=(\alph*)]
        \item
            This exercise is similar to Example 2.13.
            To show that the given formula is invalid, we find an interpretation $I$ such that
            \begin{align*}
                I \models (\forall x, y.\, p(x, y) \rightarrow p(y, x)) \land \exists z.\, \neg p(z, z).
            \end{align*}
            Choose $D_I = \{ 0, 1 \}$ and $p_I = \{ (0, 1), (1, 0) \}$.
            Both $\forall x, y.\, p(x, y) \rightarrow p(y, x)$ and $\exists z.\, \neg p(z, z)$ evaluate to $\textsf{true}$ under $I$ because
            \begin{itemize}
                \item
                    $I \models \forall x, y.\, p(x, y) \rightarrow p(y, x)$ since $I \vartriangleleft \{ x \mapsto \textsf{v}, y \mapsto \textsf{w} \} \models p(x, y) \rightarrow p(y, x)$ for any $\textsf{v}, \textsf{w} \in \{ 0, 1 \}$.
                \item
                    $I \models \exists z.\, \neg p(z, z)$ since $I \vartriangleleft \{ z \mapsto 0 \} \models \neg p(z, z)$.
            \end{itemize}
        \item
            To show that the given formula is invalid, we need to find an interpretation $I$ such that
            \begin{align*}
                I \models \exists x, y.\, p(x, y) \land p(y, x) \land \exists z.\, \neg p(z, z).
            \end{align*}
            Choose $D_I = \{ 0, 1 \}$ and $p_I = \{ (0, 1), (1, 0) \}$.
            \begin{enumerate}[label=\arabic*.]
                \item % 1
                    $I \models \exists x, y.\, p(x, y) \land p(y, x) \land \exists z.\, \neg p(z, z)$.
                \item % 2
                    $I \vartriangleleft \{ x \mapsto 0, y \mapsto 1 \} \models p(x, y) \land p(y, x) \land \exists z.\, \neg p(z, z)$ by 1 and the semantics of $\exists$.
                \item % 3
                    $I \vartriangleleft \{ x \mapsto 0, y \mapsto 1 \} \models p(x, y)$ by 2 and the semantics of $\land$.
                \item % 4
                    $I \vartriangleleft \{ x \mapsto 0, y \mapsto 1 \} \models p(y, x)$ by 2 and the semantics of $\land$.
                \item % 5
                    $I \vartriangleleft \{ x \mapsto 0, y \mapsto 1 \} \models \exists z.\, \neg p(z, z)$ by 2 and the semantics of $\land$.
                \item % 6
                    $I \vartriangleleft \{ x \mapsto 0, y \mapsto 1, z \mapsto 0 \} \models \neg p(z, z)$ by 5 and the semantics of $\exists$.
            \end{enumerate}
        \item
            To show that the given formula is invalid, we need to find an interpretation $I$ such that
            \begin{align*}
                I \models \neg((\exists x.\, p(x)) \rightarrow (\forall y.\, p(y))).
            \end{align*}
            It suffices to show that its negation normal form is satisfied by $I$.
            \begin{itemize}
                \item
                    $\neg((\exists x.\, p(x)) \rightarrow (\forall y.\, p(y)))$.
                \item
                    $\neg(\neg(\exists x.\, p(x)) \lor (\forall y.\, p(y)))$.
                \item
                    $(\exists x.\, p(x)) \land \neg(\forall y.\, p(y))$.
                \item
                    $(\exists x.\, p(x)) \land (\exists y.\, \neg p(y))$.
            \end{itemize}
            In other words, it suffices to show
            \begin{align*}
                I \models (\exists x. p(x)) \land (\exists y. \neg p(y)).
            \end{align*}
            By P.40, this is equivalent to $I \models (\exists x. p(x))$ and $I \models (\exists y. \neg p(y))$.
            Let $D_I = \{ 0, 1 \}$ and $p_I = \{ 0 \}$.
            By P.41, $I \vartriangleleft \{ x \mapsto 0 \} \models p(x)$ and $I \vartriangleleft \{ y \mapsto 1 \} \models \neg p(y)$.
    \end{enumerate}
\end{exer}

\begin{exer}[2.3]
    $ $
    \begin{enumerate}[label=(\alph*)]
        \item
            To show $\neg(\forall x.\, F) \Leftrightarrow \exists x.\, \neg F$, we will show the validity of $\neg(\forall x.\, F) \leftrightarrow \exists x.\, \neg F$.
            Suppose that it is not valid.
            Then there exists an interpretation $I$ such that $I \not\models \neg(\forall x.\, F) \leftrightarrow \exists x.\, \neg F$.
            By the semantiocs of $\leftrightarrow$, there are two branches.
            The semantics of $\land, \neg$ appear on P.10, and that of $\forall, \exists$ appear on P.42.

            The first branch is:
            \begin{enumerate}[label=\arabic*a.]
                \item % 1a
                    $I \models \neg(\forall x.\, F) \land \neg(\exists x.\, \neg F)$.
                \item % 2a
                    $I \models \neg(\forall x.\, F)$ by 1a and semantics of $\land$.
                \item % 3a
                    $I \models \neg(\exists x.\, \neg F)$ by 1a and semantics of $\land$.
                \item % 4a
                    $I \not\models \forall x.\, F$ by 2a and semantics of $\neg$.
                \item % 5a
                    $I \vartriangleleft \{ x \mapsto \textsf{v} \} \not\models F$ by 4a and semantics of $\forall$ for some fresh \textsf{v}.
                \item % 6a
                    $I \not \models \exists x.\, \neg F$ by 3a and semantics of $\neg$.
                \item % 7a
                    $I \vartriangleleft \{ x \mapsto \textsf{v} \} \not\models \neg F$ by 6a and semantics of $\exists$ for the same $\textsf{v}$.
                \item % 8a
                    $I \vartriangleleft \{ x \mapsto \textsf{v} \} \models F$ by 7a and semantics of $\neg$.
                \item % 9a
                    $I \models \bot$ by 5a and 8a.
            \end{enumerate}

            The second branch is:
            \begin{enumerate}[label=\arabic*b.]
                \item % 1b
                    $I \models \neg(\neg(\forall x.\, F)) \land \exists x.\, \neg F$.
                \item % 2b
                    $I \models \exists x.\, \neg F$ by 1b and semantics of $\land$.
                \item % 3b
                    $I \vartriangleleft \{ x \mapsto \textsf{v} \} \models \neg F$ by 2b and semantics of $\exists$ for some fresh $\textsf{v} \in D_I$.
                \item % 4b
                    $I \vartriangleleft \{ x \mapsto \textsf{v} \} \not\models F$ by 3b and semantics of $\neg$.
                \item % 5b
                    $I \models \neg(\neg(\forall x.\, F))$ by 1b and semantics of $\land$.
                \item % 6b
                    $I \not\models \neg(\forall x.\, F)$ by 5b and semantics of $\neg$.
                \item % 7b
                    $I \models \forall x.\, F$ by 6b and semantics of $\neg$.
                \item % 8b
                    $I \vartriangleleft \{ x \mapsto \textsf{v} \} \models F$ by 7b and semantics of $\forall$ for the same \textsf{v}.
                \item % 9b
                    $I \models \bot$ by 4b and 8b.
            \end{enumerate}

            Every branch of a semantic argument proof of $I \not\models F$ closes, so $F$ is valid by Theorem 2.30.
    \end{enumerate}
\end{exer}

\begin{exer}[2.4]
    $ $
    \begin{enumerate}[label=(\alph*)]
        \item
            \begin{itemize}
                \item
                    $(\forall x.\, \exists y.\, p(x, y)) \rightarrow \forall x.\, p(x, x)$.
                \item
                    $\neg (\forall x.\, \exists y.\, p(x, y)) \lor \forall x.\, p(x, x)$.
                \item
                    $(\exists x.\, \neg(\exists y.\, p(x, y))) \lor \forall x.\, p(x, x)$.
                \item
                    $(\exists x.\, \forall y.\, \neg p(x, y)) \lor \forall x.\, p(x, x)$.
                \item
                    $(\exists x.\, \forall y.\, \neg p(x, y)) \lor \forall w.\, p(w, w)$.
                \item
                    $\neg p(x, y)) \lor p(w, w)$.
                \item
                    $\exists x.\, \forall y.\, \forall w.\, \neg p(x, y)) \lor p(w, w)$.
            \end{itemize}
    \end{enumerate}
\end{exer}

\end{document}
